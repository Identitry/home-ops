---
# NSF StorageClass for media storage.
apiVersion: storage.k8s.io/v1
kind: StorageClass
metadata:
  name: media-nfs
provisioner: nfs.csi.k8s.io
parameters:
  server: ${FILESERVER_NFS_HOST}
  share: ${FILESERVER_SHARE_MEDIA_NFS_PATH}
reclaimPolicy: Retain
volumeBindingMode: Immediate
allowVolumeExpansion: false
mountOptions:
  - nfsvers=4.1 # v4.1 is very stable; use 4.2 only if you need its extras
  - hard # safest for data; pods block instead of risking corruption
  - timeo=600 # 60s RPC timeout (units are tenths of a second)
  - retrans=2 # retry a couple times before surfacing errors
  - noatime # fewer metadata writes; good for media libs
  - rsize=1048576 # 1 MiB I/O size (often helps sequential throughput)
  - wsize=1048576
  - nconnect=2 # multiple TCP conns; good on 1GbE, bump to 4 if stable
